\chapter{Interfața cu utilizatorul}
\label{chapter:ui}

Un sistem de calcul oferă resurse de calcul utilizatorului. Utilizatorul folosește o interfața de lucru furnizată de sistemul de calcul pentru activitățile sale: navigare pe Internet, dezvoltare de aplicații, creare de conținut, scriere de documente. Interfața este o aplicație a sistemului de operare numită shell. Prin interacțiunea cu shell-ul, utilizatorul își realizează activitățile și folosește resursele sistemului de calcul. De exemplu un shell grafic va prezenta utilizatorului butoane, meniuri și ferestre pe care acesta le va folosi; un shell text va prezenta utilizatorului un prompt unde acesta va introduce comenzi.

Figura TODO prezintă legătura dintre componentele sistemului de calcul. Componentele hardware sunt gestionate de sistemul de operare; peste sistemul de operare rulează aplicații, una dintre aplicații fiind shell-ul, aplicația care interfațează utilizatorul cu celelalte aplicații, cu serviciile sistemului de operare și resursele hardware,

Un sistem de operare destinat utilizatorului oferă o interfață, numită shell

diagramă hardware, sistem de operare, aplicații, shell, utilizator

Majoritatea aplicațiilor au la rândul lor o interfață. De exemplu jocurile pe calculator au o interfață grafică unde utilizatorul/jucătorul își gestionează resurse, creează armate, navighează harta; un browser web are o interfață în care se introduce adresa unui site și are zonă de redare a componentelor paginii web (text, butoane, imagini); aplicația Matlab, pentru calcule matematice complexe, oferă un prompt în care dezvoltatorul introduce comenzi specifice. În general, numim shell aplicația care interacționează cu sistemul de operare; într-un sens mai larg, putem spune și că aplicațiile de mai sus (jocul, browser-ul web, Matlab) oferă un shell, acea interfață.

Interfețele cu utilizatorul, shell-urile, vin de obicei în două moduri: grafice (Graphical User Interface - GUI) și text/linie de comandă (Command Line Interface). În general, interfața grafică este mai intuitivă, are avantajul ușurinței în utilizare și acomodare, un aspect mai plăcut, ușor personalizabil. Interfața în linia de comandă este ceva mai dificil de învățat și de folosit, mai anostă ca aspect, dar oferă acces mult mai complet și mai detaliat la serviciile sistemului. Interfața în linia de comandă permite automatizarea prin script-uri, lucru pe care îl vom discuta în Capitolul TODO: Automatizarea sarcinilor.

În Figura TODO avem două screenshot-uri cu un shell GUI și un shell CLI din distribuția Ubuntu 18.04. Shell-ul GUI oferă meniuri, butoane și ferestre, în vreme ce shell-ul CLI oferă un prompt unde se pot introduce comenzi.

screenshot GUI + CLI GNOME

În capitolul curent ne vom concentra pe interfața grafică. Interfața în linia de comandă o vom discuta detaliat în Capitolul TODO: Interfața în linia de comandă.

\section{Interfața grafică}
\label{sec:ui:gui}

Interfața grafică este comună pe majoritatea sistemelor desktop și este universală pe dispozitive mobile, dispozitive de tip smartwatch sau smart TV.

În mod clasic interfața grafică este compusă din elementele WIMP: Window, Icon, Menu, Pointer. Aceste elemente se regăsesc în interfețele cu ferestre comune sistemelor desktop. Pe sistemele mobile sau pe smart TV sau smartwatch, elementele sunt similare, cu diferența că, în mod uzual, nu sunt prezente mai multe ferestre simultan pe ecranul prezentat utilizatorului.

Pointer-ul din interfața grafică este controlat cu mouse-ul sau o telecomandă specifică sau este îndeplinit de deget pe ecranul tactil (touchscreen) al dispozitivelor mobile. Cu ajutorul acestuia se activează (prin click) elemente din interfața grafică: iconuri, meniuri, butoane, sau se poate face drag and drop sau alte acțiuni de aranjare a interfeței grafice.

Interfața grafică poate fi personalizată: scheme de culori, fonturi, dimensiuni, plasare elemente grafice pot fi modificate. Uzual noțiunea de “temă” include o agregare de fonturi, culori și plasare a elementelor; un utilizator poate selecta între diferite teme pentru a alege interfața grafică potrivită. Această personalizare are loc atât la shell-ul sistemului de operare cât și la interfața grafică expusă de diferite aplicații.

Pentru accelerarea acțiunilor în interfața grafică, există în mod uzual scurtături de tastatură. Este o practică frecventă în lumea jocurilor de calculator (unde celebrele actions-per-minute (APM)) se bazează pe folosirea scurtăturilor din tastatură. În interfața în linia de comandă scurtăturilor sunt folosite pentru gestiunea ferestrelor, accesarea rapidă a unor elemente din meniuri.

În instalările implicite, sistemele de operare desktop oferă interfața grafică. Pentru tipurile de acțiuni care necesită interfața în linia de comandă (precum acțiuni mai specifice, sau acțiuni de automatizare sau acțiuni care nu se pot realiza altfel), se pot porni shell-uri CLI din interfața grafică. Într-un mediu GNOME se poate porni o fereastră GNOME terminal, în într-un mediu grafic Windows se poate porni o fereastră PowerShell. În Figura TODO sunt screenshot-uri cu două ferestre din mediul GUI în care rulează un shell CLI. Este modul uzual în care rulăm comenzi în sistemele desktop moderne.

screenshot GNOME Terminal + screenshot PowerShell

\subsection{Interfețe native și interfețe web}
\label{sec:ui:native-web}

Interfețele web sunt tot forme de interfața grafică, folosind componente precum meniuri, iconuri, pointer, butoane. Spunem că o aplicație are interfață GUI dacă rulează de sine stătătoare pe un sistem de calcul, numite și aplicații native. Altfel, aplicațiile web oferă o interfață grafică web (numită și WebUI) în cadrul unui browser.

De avut în vedere că în ultimii ani, asistăm la o migrare spre interfețe grafice web. Sistemele de operare desktop moderne oferă mai puține aplicații preinstalate, majoritatea elementele grafice (WIMP) fiind migrate în aplicații web. Adesea, un utilizator va porni un browser și din browser își va executa majoritatea acțiunilor: urmărit filme, ascultat muzică, lucrat la documente folosind suita Google Docs sau Office 360, comunicat online (Messenger, Hangouts), publicat conținut (Facebook, Pinterest), inclusiv dezvoltarea de aplicații.

Aplicațiile web sunt uzuale mediului desktop. În mod obișnuit, pe dispozitivele mobile sau de tip smart TV sau altele, aceste aplicații sunt aplicații native. În continuare pot fi accesate și prin browser, dar forma uzuală este cea de aplicație nativă.

Motivul migrării aplicațiilor desktop în aplicații web este portabilitatea: dat fiind un browser (Mozilla Firefox, Google Chome sau altul), aplicațiile web se vor comporta la fel indiferent de sistemul de operare sau distribuția rulată. Altfel, este nevoie de o aplicație nativă pentru fiecare sistem de operare/distribuție. În zona dispozitivele mobile sau smart TV, furnizorul dispozitivului oferă și sistemul de operare iar aplicațiile sunt create doar pentru acesta.

\subsection{Utilizabilitate și experiența utilizatorului}
\label{sec:ui:ux}

În proiectarea interfeței grafice este esențial ca această să fie cât mai intuitivă și ușor de folosit. Noțiunea de experiența utilizatorului (User Experience, UX) este centrală pentru aplicațiile și dispozitivele cu interfața grafică. O interfața încărcată, cu elemente greu accesibile sau neintuitiv plasate va fi respinsă de utilizator care va alege altă aplicație sau altă platformă.

Organizațiile care dezvoltă interfețe grafice stabilesc principii și recomandări de urmat. Acest principii țin cont de natura umană și comportamentul utilizatorilor, în general din studii specifice, și se regăsesc în documente numite Human Interface Guidelines (Ghiduri de interfațare om-calculator). Exemple de organizații și astfel de documente sunt:

GNOME: GNOME Human Interface Guidelines
Apple: Apple Human Interface Guidelines
Android: Android Design Guidelines
Microsoft: Microsoft User Interface Principles

O aplicație sau un dispozitiv de succes va trebuie să țină cont și de interfața grafică, nu numai de funcționalitățile și performanța sa. Aspectele ce țin de experiența utilizatorului sunt cu atât mai importante pe dispozitivele mobile unde interfața grafică tactilă este universală. În aceeași măsură aplicațiile și site-urile web necesită interfețe intuitive pentru satisfacția utilizatorilor acestora. Un utilizator nemulțumit sau încurcat de interfață nu va folosi aplicația, lucru care se traduce în general în pierderi financiare. De aceea aspectele de ce țin de experiența utilizatorului sunt esențiale pentru dezvoltatorii de aplicații pe dispozitive mobile sau aplicații web.

\section{Interfața grafică în Linux}
\label{sec:ui:linux-gui}

Așa cum am precizat și în Capitolul TODO: Introducere, Linux (sau mai bine spus, distribuțiile software bazate pe Linux) rulează pe o plajă largă de sisteme și dispozitive: server, desktop/laptop, mobile (Android), smart TV, smart watch, rutere/echipamente de rețea etc. Fiecare dintre aceste sisteme oferă o interfață utilizatorului:

interfață grafică tactilă în cazul dispozitivelor mobile sau smart watch
interfață grafică și telecomandă în cazul smart TV
interfață în linie de comandă sau interfață web de configurare în cazul echipamentelor de rețea
interfață în linie de comandă în cazul serverelor
interfață grafică și în linie de comandă în cazul sistemelor desktop/laptop

În cele ce urmează vom prezenta interfața grafică în cazul sistemelor desktop/laptop. Deși nu este obișnuit, această interfață poate fi prezentă și în cazul sistemelor server. Interfața în linia de comandă va fi prezentată în formă de comenzi Linux în restul capitolelor și detaliat în Capitolul TODO: Interfața în linia de comandă.

\subsection{Desktop Environments}
\label{sec:ui:desktop-environments}

Suita de componente software care oferă interfața grafică utilizatorului într-un sistem de operare formează un mediu desktop (desktop environment), așa numitul shell GUI. Putem spune că toate sistemele de operare oferă un desktop environment, indiferent de tipul de dispozitiv pe care rulează. Termenul a fost însă popularizat și este folosit cu precădere în lumea Unix/Linux.

În lumea Linux posibilitatea de personalizare a distribuțiilor software este foarte mare, inclusiv a mediului desktop folosit. O distribuție Linux oferă o variantă implicită de mediu desktop, care poate fi însă modificată.

Alegerea unui mediu desktop ține de consumul de resurse, de posibilitățile de personalizare și preferința și istoricul utilizatorului. Un mediu desktop oferă un anume aspect și o plasare a componentelor software, aplicații specifice pentru acțiuni uzuale (navigare în sistemul de fișiere, navigare web, redare multimedia, editor text, emulator de terminal).

Exemple de medii desktop pe Linux sunt GNOME, KDE, MATE, Cinnamon, Budgie, Xfce. O comparație a acestora și referințe la articole comparative este pe Wikipedia. Aplicații grafice de bază (precum brower-ul în sistemul de fișiere, editor text, player multimedia) sunt parte a fiecărui mediu desktop, fiecare cu particularitățile sale. Alte aplicații grafice sunt instalate, majoritatea nefiind specifice unui mediu desktop; de exemplu, Mozilla Firefox este un browser web iar VLC este player multimedia nespecifice unei distribuții.

\subsection{Sistemul de ferestre (Window System)}
\label{sec:ui:window-system}

Redarea elementelor grafice ale unei aplicații ce rulează peste sistemul de operare este gestionată de sistemul de ferestre. Sistemul de ferestre este un ansamblu software care interacționează cu sistemul de operare, componente ale mediului desktop și cu aplicațiile. Fiecare sistem de operare (nu doar Linux) are un sistem de ferestre. Pe Windows, este reprezentat de Desktop Windows Manager, pe macOS este reprezentat de Quartz și Core Graphics.

Sistemul de ferestre este compus în mod uzual din:

Manager de ferestre/afișare (window/display manager): gestionează așezarea ferestrelor pe ecran, uzual încluzând bare de meniuri.
Widget/GUI toolkit: colecție de biblioteci care oferă elementele grafice (numite widget-uri), folosit de managerul de ferestre.
Server de ferestre/afișare (window/display server): interacționează printr-un protocol specific cu aplicațiile grafice, cu sistemul de operare și managerul de ferestre pentru redarea componentelor grafice.

Schematic, componentele sistemului de ferestre sunt indicate în Figura TODO:

de folosit imaginea asta (https://en.wikipedia.org/wiki/Display_server#/media/File:Schema_of_the_layers_of_the_graphical_user_interface.svg) cu menționarea autorului și văzut compatibilitatea licenței

Delimitarea între componentele de mai sus ale sistemului de ferestre nu este strictă, mai ales în sistemele de operare diferite de Linux.

În mod implicit, managerii de ferestre folosiți implicit pe majoritatea distribuțiilor Linux sunt flotanți (floating/stacking window manager). Adică ferestrele pot fi suprapuse și mișcate în funcție de preferințele utilizatorilor. Un alt tip de manager de ferestre este cel bazat pe secțiuni (tiling window manager); în acest caz fiecare fereastră ocupă un spațiu fix în ecran, fără a se suprapune cu alte ferestre; ecranul este secționat cu ferestre diferite ocupând un spațiu nesupraspus cu altele. Exemple de tiling window managers sunt i3, awesome, bspwm. Unii manageri sunt dinamici permițând tranziția între modul floating și modul tiling.

În Linux, în mod tradițional, sistemul de ferestre folosit este X Window System, sau, mai simplu, X. În ultima perioadă a căpătat tracțiune alternativa Weyland/Weston, apărută ca reacție la complexitatea X. Weyland/Weston se dorește o înlocuire a X, fiind o soluție mai simplă și cu proiectare mai sigură. Weyland/Weston nu este încă adoptat pe scară largă, astfel că multe distribuții sau medii desktop preferă folosirea X, care este mai stabil.

Aspectul comun al X și Weyland este interacțiunea componentelor. X și Weyland sunt de fapt specificații de protocoale și implementări de referință ale acestora pentru interacțiunea între serverul de ferestre (window server) și aplicațiile grafice (clienți grafici).

Schema de funcționare a X/Weyland este prezentată în Figura TODO:

figură cu X server/Weyland, aplicație, ecran/tastatură, protocolul X/Weyland

În această interacțiune, o aplicație precum Mozilla Firefox este client grafic; folosind protocolul X/Weyland aceasta transmite către serverul X/Weyland cerințele sale de afișare grafică pe ecran, sau acțiunile utilizatorului. Practic, aplicația client se ocupă de resursele sale de calcul lăsând serverului grafic responsabilitatea interacțiunii cu utilizatorul.

Una dintre funcționalitățile X, absentă din Weyland, este folosirea peste rețea. În această situație, aplicația client rulează pe un sistem la distanță, iar serverul X rulează pe sistemul local. În acest caz, utilizatorul interacționează cu serverul X local: acțiunile sale sunt transmise serverului, iar redarea se face pe afișajul local; aplicația client rulează însă pe sistemul de la distanță, consumul de resurse (procesor, memorie, sistem de fișiere) făcându-se pe acel sistem. Interacțiunea între aplicația client și aplicația server are loc prin rețea prin intermediul protocolului X. Acest lucru este prezentat în Figura TODO.

figură cu utilizator, acțiuni/evenimente + afișare, server X, rețea + protocol X, client X (aplicație), resurse hardware la distanță

Aplicații grafice pot fi rulate la distanță și dacă sistemul local rulează Windows sau macOS. Pentru aceasta este nevoie de instalarea unui server X nativ Windows, precum XMing, sau macOS precum XQuartz.

În mod uzual, din rațiuni de securitate, rularea la distanță de aplicații X grafice se realizează peste un canal SSH, protocol despre care vom discuta în Capitolul TODO: Rețelistică și Internet.

\subsection{Funcționalități ale interfeței grafice în Linux}
\label{sec:ui:linux-gui-features}

Pe lângă interfața grafică efectivă, interfața grafică în Linux oferă funcționalități specifice utilizatorilor.

O astfel de funcționalitatea este noțiunea de spațiu de lucru (workspace) sau desktop. Într-o sesiune de mediu grafic pot exista mai multe workspace-uri/desktop-uri, fiecare cu ferestrele sale, utilizatorul putând migra între workspace-uri pentru a-și păstra aplicațiile izolate. Depinzând de mediul desktop, numărul de workspace-urile este static configurabil (fixat într-o configurație) sau dinamic (se poate crea rapid un workspace nou). În oricare situație, acțiunile sunt: tranziție la un alt workspace sau mutare fereastră într-un alt workspace. O funcționalitate similară este prezentă pe macOS și în Windows, de la Windows 10.

Folosirea scurtăturilor de tastatură (keyboard shortcuts) este utilă pentru acțiuni rapide în cadrul mediului grafic. În general orice mediu grafic oferă scurtături pentru pornire de aplicații, închidere de aplicații, deschidere și închidere de tab-uri de aplicație, minimizat ferestre, accesat meniuri, schimbat între ferestre. Aceste scurtături depind de sistemul de operare și mediul desktop folosit. O listă a scurtăturilor folosite pe mașina virtuală de suport a acestei cărți este în Tabelul TODO.

O parte dintre acțiunile utilizatorului pot fi realizate doar sau mai rapid în interfața în linia de comandă. Pentru acesta, din mediul grafic se pot porni rapid aplicații shell în linia de comandă, în forma emulatoarelor de terminal. Un emulator de terminal este o aplicație care prezintă utilizatorului o fereastră. În această fereastră rulează un shell CLI unde utilizatorul poate rula comenzi. În Figura TODO, imaginea din stânga este o fereastră de emulator de terminal în GNOME (aplicația gnome-terminal) în care rulează shell-ul Bash; în mod similar, în dreapta este o fereastră Windows în care rulează shell-ul PowerShell. Pe macOS acest rol în are aplicația Terminal, care vine preinstalată cu sistemul de operare. Sunt și alte emulatoare de terminal care pot fi instalate în locul sau pe lângă cele implicite. Mai multe informații despre terminale, emulatoare de terminal și shell vom prezenta în Capitolul TODO: Interfața în linia de comandă.

\section{Interfața grafică în mașina virtuală de suport}
\label{sec:ui:vm}

Distribuțiile, mediile desktop, managerii de ferestre și a aplicații Linux sunt diverse. Este dificil de găsit un numitor comun de aspecte generice, comune tuturor. În această secțiune vom prezenta informații specifice mașinii virtuale de suport a cărții, mașină care rulează Ubuntu 18.04.

Așa cum am precizat mai sus, pentru acțiuni rapide în interfața grafică a unui sistem de operare (și, în general, a unei aplicații) sunt utile scurtăturile de tastatură. Tabelul TODO conține cele mai comune scurtături în mașina virtuală:

În ce aplicație e folosită, scurtătură, efect

O scurtătură frecventă de tastatură, întâlnită pe majoritatea distribuțiilor și mediilor desktop, este Alt+F2 folosită pentru pornirea rapidă a unei aplicații, introducând numele comenzii, la fel ca în Figura TODO. Funcționalitatea este numită application launcher. Echivalentul în Windows este Windows+R, iar în macOS Command+Space.

O acțiune frecventă la instalarea sistemului de calcul este configurarea schemei de tastaturii (keyboard layout). Dacă dorim adăugarea unei noi scheme de tastatură, acest lucru se face prin accesarea meniului de tastatură din pașii TODO. Vom ajunge la un ecran precum cel din Figura TODO, unde putem configura noi scheme de tastatură.
fereastra finală din keyboard layout

În general configurațiile se pot realiza din meniurile aplicațiilor. Anumite configurații (precum dezactivarea introducerii parolei la autentificare) necesită accesarea interfeței de configurare. Pentru aceasta folosim aplicația dconf-editor, la fel ca în Figura TODO, cu care avem acces la o plajă largă de opțiuni de configurare.

În general, desktop-ul nu este folosit pentru a reține desktop shortcuts sau alte iconuri. Aceasta pentru că aplicațiile pot fi pornite rapid folosit scurtătura de tip application launcher (Alt+F2). Dacă însă dorim să creăm un desktop shortcut, putem face acest fie creând manual un fișier cu extensia .desktop sau folosind comanda gnome-desktop-item-edit.

\section{Sumar}
\label{sec:ui:summary}

Sistemul de operare oferă o interfață (shell) pentru interacțiunea utilizatorului cu aplicațiile și sistemul de operare.

Shell-ul poate fi grafic (GUI) sau în linia de comandă. Shell-ul grafic este mai intuitiv și preferat majorității utilizatorilor. Interfața în linia de comandă permite acces la un spațiu mai mare de opțiuni și acțiuni și posibilitatea automatizării prin script-uri.

Interfața grafică este compusă din elemente grafice acționate cu mouse-ul sau tactil, sub acronimul WIMP (Window, Icon, Menu, Pointer).

Interfața grafică trebuie să fie simplă și intuitivă. Aplicațiile și sistemele de operare urmăresc recomandări de proiectare a interfeței pentru a oferi o experiență bună utilizatorului.

În Linux interfața grafică vine în formă de mediu desktop (Desktop environment), o suită software cu shell grafic, aplicații grafice și opțiuni de configurare specifice. Exemple sunt GNOME și KDE.

Mediul grafic se bazează pe un sistem de ferestre. În Linux, în mod tradițional este folosit sistemul de ferestre X. În ultimi ani, a prins tracțiune sistemul de ferestre Weyland/Weston.

Mașina virtuală de suport a acestei cărți folosește un sistem de operare Ubuntu 18.04 cu interfață grafică GNOME.
